# GoMT4 Documentation – Skeleton

> Version: v0 (starter scaffold). Goal: fill step‑by‑step with clear, beginner‑friendly explanations and runnable snippets.

---

## 📑 Table of Contents

* [Introduction](Introduction.md)
* [Setup & Environment](setup.md)
* [Architecture & Data Flow](Architecture_DataFlow.md)
* [Reliability: Timeouts, Reconnects, Backoff](ReTimeouts_Reconnects_Backoff.md)
* [Troubleshooting & FAQ](Troubleshooting_FAQ.md)
* [Cookbook (Recipes)](Cookbook/)

  * Account
    - [Show Account Summary](Cookbook/Account/AccountSummary.md)
    - [Stream Opened Order Profits](Cookbook/Account/StreamOpenedOrderProfits.md)
  * Market Info
    - [Get Symbol Params](Cookbook/Market_Info/SymbolParams.md)
    - [History Orders](Cookbook/Market_Info/HistoryOrders.md)
  * Orders
    - [Place Market Order](Cookbook/Orders/PlaceMarketOrder.md)
    - [Place Pending Order](Cookbook/Orders/PlacePendingOrder.md)
    - [Modify Order](Cookbook/Orders/ModifyOrder.md)
    - [Close Order](Cookbook/Orders/CloseOrder.md)
    - [Close By Orders](Cookbook/Orders/CloseByOrders.md)
    - [Delete Pending](Cookbook/Orders/DeletePending.md)
    - [History Orders](Cookbook/Orders/HistoryOrders.md)
  * Reliability & Connection
    - [Handle Reconnect](Cookbook/Reliability_Connection/HandleReconnect.md)
    - [Unary Retries](Cookbook/Reliability_Connection/UnaryRetries.md)
    - [Health Check](Cookbook/Reliability_Connection/HealthCheck.md)
  * Utils & Helpers
    - [Round Volume/Price](Cookbook/Utils_Helpers/RoundVolumePrice.md)
    - [Ensure Symbol Visible](Cookbook/Utils_Helpers/EnsureSymbolVisible.md)
    - [Config Example](Cookbook/Utils_Helpers/ConfigExample.md)

* [CLI Usage (Playground)](cli_usage.md)
* [API Reference (Types & Enums)](API%20Reference/Overview.md)

  * [Enums](API%20Reference/Enums.md)
  * [Messages](API%20Reference/Messages.md)
  * [Streaming](API%20Reference/Streaming.md)

* [Performance Notes](Performance_Notes.md)
* [Security & Secrets](Security_Secrets.md)
* [Observability (Logs & Metrics)](Observability.md)
* [Glossary (MT4 Terms)](Glossary.md)


---

## Introduction

**What is GoMT4?**

* Short description of the project and its purpose.
* Who is it for: beginners, algo devs, ops.
* Quick links: Getting Started, CLI, Example app.

**Outcomes after reading:**

* Run a local demo.
* Connect to a terminal.
* Subscribe to quotes.
* Place/close an order in a safe way.

---

## Setup & Environment

**Goal:** Run everything on Windows with MT4 installed.

### Prerequisites

* Windows 10/11, MT4 Terminal installed.
* Go ≥ 1.21, protoc + gRPC plugins.
* VS Code (recommended) with Go extension.

### Install Steps (draft)

1. Install Go and protoc.
2. Clone repo and run `go mod tidy` in modules.
3. Configure MT4 terminal path and credentials via `.env`.
4. Open VS Code; provide `launch.json` for debugging.

---

## Architecture & Data Flow

**Goal:** Make the system non‑magical.

* Diagram: MT4 Terminal ⇄ gRPC server ⇄ Go client(s).
* Lifecycles: connect → use → disconnect.
* Streams: Quotes, Orders; channels and backpressure.
* Where retries/backoff happen.


---

## Reliability: Timeouts, Reconnects, Backoff

**Guidelines:**

* `context.WithTimeout` for unary calls (2–5s baseline).
* Treat `io.EOF` as transient on streams; reconnect with jitter (±250ms).
* Cancel path wiring: context cancellation closes goroutines.
* Avoid leaking streams; health checks.

**Code patterns:**

```go
// Pseudocode for unary with timeout
ctx, cancel := context.WithTimeout(parent, 3*time.Second)
defer cancel()
resp, err := client.Do(ctx, req)
// handle err
```

```go
// Stream reconnection loop (outline)
for attempt := 0; ; attempt++ {
  stream, err := client.Stream(ctx, req)
  if err != nil { backoff(attempt); continue }
  for {
    msg, err := stream.Recv()
    if err == io.EOF || isTransient(err) {
      backoff(attempt)
      break // reconnect
    }
    if err != nil { return err }
    handle(msg)
  }
}
```

---

## Troubleshooting & FAQ

* **“Symbol not found EURUSD”** → Broker suffix: try `EURUSD.m`.
* **“Invalid volume”** → Check `MinLot`/`LotStep` and round correctly.
* **“Digits mismatch”** → Use symbol `Digits` to format prices.
* **“No connection / timeouts”** → Firewall/UAC, terminal path, server ping.


---

## Cookbook (Recipes)

### Watchlist & Quotes

* Build a list of symbols; ensure visibility; poll or stream quotes.
* Example code block (to be filled with actual API calls).

### Place Order Safely

* Validate symbol trading mode; round volume/price; slippage; error handling.

### Compute PnL Correctly

* Use `TickValue`/`ContractSize`; convert to account currency if needed.

### Stream History to DB

* Paginate history; write batched inserts; idempotency tips.


---

## CLI Usage (Playground)

* Subscribe to quotes.
* Dump symbol params.
* Close orders by filter.

> TODO: list commands and flags + examples.

---

## API Reference (Types & Enums)

* Autogenerated types index with human‑readable notes.
* Units, ranges, and gotchas.

> TODO: link to proto docs and add field explanations.

---

## Performance Notes

* Batch calls where possible; avoid per‑tick RPCs.
* Expected latencies; simple load test plan.

---

## Security & Secrets

* `.env` handling, do not commit; Windows credential hints.
* Minimal terminal permissions.

---

## Observability (Logs & Metrics)

* Log format and levels.
* Basic metrics: latency, reconnects, dropped ticks.

---

## Glossary (MT4 Terms)

* Digits, Point, TickSize, TickValue, Lot, ContractSize.
* Hedging vs Netting (note if MT5 differences matter).


